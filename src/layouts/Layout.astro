---
import "../styles/global.css";
import Header from "../components/layout/Header.astro";
import Footer from "../components/layout/Footer.astro";
import SEO from "../components/head/SEO.astro";
import { getHtmlLang, getTextDirection } from "../utils/i18n";

export interface Props {
  title?: string;
  description?: string;
  image?: string | { src: string } | undefined;
  article?: boolean;
  pubDate?: Date;
  lang?: "en" | "fr" | "ru" | "de";
  review?: {
    productName: string;
    rating: number;
    image?: string | { src: string } | undefined;
    pubDate?: Date;
  };
}

const {
  title = "HardwareLab - Expert Hardware Reviews",
  description = "In-depth analysis of CPUs, GPUs, motherboards and other computer components",
  image,
  article = false,
  pubDate,
  lang = "en",
  review,
} = Astro.props;

const htmlLang = getHtmlLang(lang);
const textDirection = getTextDirection();
---

<!doctype html>
<html lang={htmlLang} dir={textDirection} class="scroll-smooth">
  <head>
    <SEO
      title={title}
      description={description}
      image={image}
      article={article}
      lang={lang}
      {...(pubDate ? { pubDate } : {})}
      {...(review ? { review } : {})}
    />
  </head>

  <body
    class="bg-primary-50 text-primary-900 dark:bg-primary-950 dark:text-primary-100 font-sans min-h-screen flex flex-col transition-colors duration-300"
  >
    <Header lang={lang} />

    <main class="flex-grow container mx-auto px-4 py-8">
      <slot />
    </main>

    <Footer lang={lang} />

    <script>
      // Theme toggle
      const themeToggle = document.getElementById("theme-toggle");
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)");

      function setTheme(theme: string) {
        document.documentElement.classList.toggle("dark", theme === "dark");
        localStorage.setItem("theme", theme);
      }

      function toggleTheme() {
        const isDark = document.documentElement.classList.contains("dark");
        setTheme(isDark ? "light" : "dark");
      }

      // Initialize theme
      const storedTheme = localStorage.getItem("theme");
      if (storedTheme) {
        setTheme(storedTheme);
      } else if (prefersDark.matches) {
        setTheme("dark");
      }

      if (themeToggle) {
        themeToggle.addEventListener("click", toggleTheme);
      }
    </script>
  </body>
</html>
